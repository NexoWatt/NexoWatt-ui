{
  "type": "tabs",
  "items": {
    "allgemein": {
      "type": "panel",
      "items": {
        "port": {
          "type": "number",
          "label": "HTTP Port",
          "min": 1,
          "max": 65535,
          "attr": "port",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "bind": {
          "type": "text",
          "label": "Bind-Adresse",
          "attr": "bind",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "units.power": {
          "type": "select",
          "label": "Leistungseinheit",
          "options": [
            {
              "label": "W",
              "value": "W"
            },
            {
              "label": "kW",
              "value": "kW"
            }
          ],
          "attr": "units.power",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "settings.dynamicTariff": {
          "type": "checkbox",
          "label": "Tarif jetzt",
          "default": false,
          "attr": "settings.dynamicTariff",
          "xs": 12,
          "sm": 12,
          "md": 6
        }
      },
      "label": "Allgemein",
      "title": "Allgemein"
    },
    "datenpunkte": {
      "type": "panel",
      "items": {
        "datapoints.productionTotal": {
          "type": "objectId",
          "label": "PV – Leistung (W)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. fronius.0.powerflow.P_PV (oder Summe AC Leistung)",
          "help": "Aktuelle PV-Leistung in W. Wird in der Live-Kachel „Produktion“ angezeigt.",
          "newLine": false,
          "attr": "datapoints.productionTotal",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "datapoints.pvPower": {
          "type": "objectId",
          "label": "PV – Leistung (W) (optional, Alternative)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. fronius.0.powerflow.P_PV",
          "help": "Optionaler zweiter PV-Leistungs-Datenpunkt. Wird genutzt, falls „PV – Leistung (W)“ leer ist oder als Fallback für Berechnungen.",
          "newLine": false,
          "attr": "datapoints.pvPower",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "datapoints.gridBuyPower": {
          "type": "objectId",
          "label": "Netz – Bezug (W)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. smartmeter.0.power.import",
          "help": "Positive Leistung Bezug. Alias: 0_userdata.0.nexowatt.grid.buy.power",
          "newLine": false,
          "attr": "datapoints.gridBuyPower",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "datapoints.gridSellPower": {
          "type": "objectId",
          "label": "Netz – Einspeisung (W)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. smartmeter.0.power.export",
          "help": "Positive Leistung Einspeisung. Alias: 0_userdata.0.nexowatt.grid.sell.power",
          "newLine": false,
          "attr": "datapoints.gridSellPower",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "ui.emsGridSourceInfo": {
          "type": "header",
          "text": "EMS‑Hinweis: Für Peak‑Shaving/Charging/Speicher nutzt das EMS die Netzpunktleistung (NVP) als Netto‑Signal (Import + / Export −). Empfehlung: Entweder hier einen Netto‑Datenpunkt setzen oder Bezug/Einspeisung getrennt mappen. Doppelte Zuordnungen in den EMS‑Reitern sind i. d. R. nicht nötig.",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "datapoints.gridPointPower": {
          "type": "objectId",
          "label": "Netzpunkt (NVP) – Nettoleistung (W) (Import + / Export −) (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. smartmeter.0.power.net",
          "help": "Optionaler Netto‑Datenpunkt am Netzanschlusspunkt. Wenn gesetzt, verwendet das EMS bevorzugt diesen Wert. Wenn leer, wird die Netto‑Leistung aus „Netz – Bezug“ und „Netz – Einspeisung“ berechnet.",
          "newLine": false,
          "attr": "datapoints.gridPointPower",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "datapoints.storageChargePower": {
          "type": "objectId",
          "label": "Batterie – Ladeleistung (W)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "attr": "datapoints.storageChargePower",
          "xs": 12,
          "sm": 12,
          "help": "Aktuelle Ladeleistung der Batterie in W (positiver Betrag).",
          "md": 6,
          "placeholder": "z.B. battery.0.power.charge"
        },
        "datapoints.storageDischargePower": {
          "type": "objectId",
          "label": "Batterie – Entladeleistung (W)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "attr": "datapoints.storageDischargePower",
          "xs": 12,
          "sm": 12,
          "help": "Aktuelle Entladeleistung der Batterie in W (positiver Betrag).",
          "md": 6,
          "placeholder": "z.B. battery.0.power.discharge"
        },
        "datapoints.consumptionTotal": {
          "type": "objectId",
          "label": "Gebäude – Leistung (W)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. smartmeter.0.power.house (oder Summe Verbrauch AC)",
          "help": "Aktueller Gebäude-/Hausverbrauch in W. Empfohlen: fenecon.0._sum.ConsumptionAcActivePower",
          "newLine": false,
          "attr": "datapoints.consumptionTotal",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "datapoints.consumptionEvcs": {
          "type": "objectId",
          "label": "Wallbox (EVCS) – Leistung (W)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "attr": "datapoints.consumptionEvcs",
          "xs": 12,
          "sm": 12,
          "help": "Aktuelle Ladeleistung der Wallbox(en) in W (Summe, falls mehrere).",
          "md": 6,
          "placeholder": "z.B. wallbox.0.power"
        },
        "datapoints.consumptionOther": {
          "type": "objectId",
          "label": "Verbrauch – Sonstiges (W) (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "attr": "datapoints.consumptionOther",
          "xs": 12,
          "sm": 12,
          "help": "Optional: zusätzlicher Verbraucher-Leistungswert in W (falls genutzt).",
          "md": 6,
          "placeholder": "z.B. consumer.0.power",
          "expert": true
        },
        "datapoints.consumer1Power": {
          "type": "objectId",
          "attr": "datapoints.consumer1Power",
          "label": "Verbraucher 1 Leistung (W)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "placeholder": "z.B. consumer1.0.power",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "datapoints.consumer2Power": {
          "type": "objectId",
          "attr": "datapoints.consumer2Power",
          "label": "Verbraucher 2 Leistung (W)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "placeholder": "z.B. consumer2.0.power",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "datapoints.storageSoc": {
          "type": "objectId",
          "label": "Batterie – SoC (%)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "attr": "datapoints.storageSoc",
          "xs": 12,
          "sm": 12,
          "help": "State of Charge in %. Empfohlen: fenecon.0._sum.EssSoc",
          "md": 6
        },
        "datapoints.evcsStatus": {
          "type": "objectId",
          "label": "EVCS Status",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. evcc.0.wallbox.status",
          "help": "Wallbox Status",
          "newLine": false,
          "attr": "datapoints.evcsStatus",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "datapoints.gridFrequency": {
          "type": "objectId",
          "label": "Netzfrequenz (Hz)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. smartmeter.0.grid.frequency",
          "help": "Netzfrequenz Hz",
          "newLine": false,
          "attr": "datapoints.gridFrequency",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "datapoints.gridVoltage": {
          "type": "objectId",
          "label": "Netzspannung (V)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. smartmeter.0.grid.voltage",
          "help": "Netzspannung V",
          "newLine": false,
          "attr": "datapoints.gridVoltage",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "datapoints.storageCapacityKwh": {
          "type": "objectId",
          "label": "Speicher Kapazität (kWh)",
          "attr": "datapoints.storageCapacityKwh",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "placeholder": "z.B. 0_userdata.0.nexowatt.storage.capacity_kwh",
          "help": "Kapazität des Batteriespeichers in kWh (Zahl).",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "datapoints.autarky": {
          "type": "objectId",
          "label": "KPI – Autarkie (%)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.autarky",
          "help": "Autarkie in %. Falls leer, wird aus PV/Verbrauch geschätzt.",
          "newLine": false,
          "attr": "datapoints.autarky",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "datapoints.selfConsumption": {
          "type": "objectId",
          "label": "KPI – Eigenverbrauch (%)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.selfConsumption",
          "help": "Eigenverbrauch in %. Falls leer, wird geschätzt.",
          "newLine": false,
          "attr": "datapoints.selfConsumption",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "datapoints.priceCurrent": {
          "type": "objectId",
          "label": "Tarif – aktuell (€/kWh oder ct/kWh)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.price.current",
          "help": "Numerisch. Wenn in ct/kWh geliefert, wird automatisch in €/kWh umgerechnet.",
          "attr": "datapoints.priceCurrent",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "datapoints.priceAverage": {
          "type": "objectId",
          "label": "Tarif – Durchschnitt (€/kWh oder ct/kWh)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.price.average",
          "help": "Numerisch. Wenn in ct/kWh geliefert, wird automatisch in €/kWh umgerechnet.",
          "attr": "datapoints.priceAverage",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        
        "datapoints.tariffHomePath": {
          "type": "objectId",
          "label": "Tarif – Quelle (Ordnerpfad)",
          "types": [
            "channel"
          ],
          "button": true,
          "placeholder": "z.B. tibber.0.Homes.<uuid>",
          "help": "Basis-Ordner eines Tarif-Adapters. Wenn gesetzt, werden Standard-States automatisch erwartet: CurrentPrice.total, PricesToday.json, PricesTomorrow.json (ggf. per Alias nachbilden).",
          "attr": "datapoints.tariffHomePath",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "datapoints.priceTodayJson": {
          "type": "objectId",
          "label": "Tarif – Preise heute (JSON)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. tibber.0.Homes.<uuid>.PricesToday.json",
          "help": "String/JSON Array mit Stundenpreisen (z.B. [{\"total\":0.318,\"startsAt\":\"...\"}, ...]). Optional, falls 'Quelle (Ordnerpfad)' gesetzt ist.",
          "attr": "datapoints.priceTodayJson",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "datapoints.priceTomorrowJson": {
          "type": "objectId",
          "label": "Tarif – Preise morgen (JSON)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. tibber.0.Homes.<uuid>.PricesTomorrow.json",
          "help": "String/JSON Array mit Stundenpreisen für morgen. Viele Provider aktualisieren diese Daten gegen 14:00 Uhr. Optional, falls 'Quelle (Ordnerpfad)' gesetzt ist.",
          "attr": "datapoints.priceTomorrowJson",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "tariff.autoBandEur": {
          "type": "number",
          "label": "Tarif Automatik: Band um Tagesminimum (€/kWh)",
          "default": 0.03,
          "min": 0,
          "max": 1,
          "step": 0.001,
          "help": "Im Modus 'Automatisch' gilt ein Preis als günstig, wenn aktueller Preis <= (Minimum im Planungshorizont + Band). Standard: 0,03 €/kWh (= 3 ct).",
          "attr": "tariff.autoBandEur",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
"datapoints.co2Savings": {
          "type": "objectId",
          "label": "CO₂ – Ersparnis",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "attr": "datapoints.co2Savings",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "settings.flowSubtractEvFromBuilding": {
          "type": "checkbox",
          "label": "EV-Leistung vom Gebäude-Verbrauch abziehen",
          "default": true,
          "help": "Wenn aktiv, wird die Ladeleistung der Wallbox (consumptionEvcs) von 'Gebäude' (Mitte) subtrahiert.",
          "attr": "settings.flowSubtractEvFromBuilding",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "settings.flowInvertBattery": {
          "type": "checkbox",
          "label": "Batterie-Vorzeichen invertieren (Laden/Entladen tauschen)",
          "default": false,
          "help": "Standard: Negativ = Laden, Positiv = Entladen. Bei Herstellern mit umgekehrtem Vorzeichen aktivieren.",
          "attr": "settings.flowInvertBattery",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "settings.flowInvertGrid": {
          "type": "checkbox",
          "label": "Netz-Vorzeichen invertieren (Bezug/Einspeisung tauschen)",
          "default": false,
          "help": "Standard: Positiv = Bezug, Negativ = Einspeisung.",
          "attr": "settings.flowInvertGrid",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "settings.flowInvertPv": {
          "type": "checkbox",
          "label": "PV-Vorzeichen invertieren",
          "default": false,
          "help": "Standard: PV > 0 (Erzeugung Richtung Gebäude).",
          "attr": "settings.flowInvertPv",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "settings.flowInvertEv": {
          "type": "checkbox",
          "label": "Wallbox-Vorzeichen invertieren",
          "default": false,
          "help": "Standard: Wallbox-Verbrauch positiv.",
          "attr": "settings.flowInvertEv",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "settings.flowGridShowNet": {
          "type": "checkbox",
          "label": "Netz: Netto (Bezug−Einspeisung) anzeigen",
          "default": false,
          "help": "Wenn aus, wird die dominante Richtung (Bezug oder Einspeisung) mit ihrem Betrag angezeigt.",
          "attr": "settings.flowGridShowNet",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "ui.advancedDatapointsInfo": {
          "type": "header",
          "text": "Erweitert: Zählerstände/kWh & Kennzahlen (standardmäßig ausgeblendet – im Admin „Expertenmodus“ sichtbar).",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "expert": true
        },
        "datapoints.productionEnergyKwh": {
          "type": "objectId",
          "label": "Produktion – Energie gesamt (kWh)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "attr": "datapoints.productionEnergyKwh",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true,
          "help": "Optional. Wenn leer, kann die VIS später Energie-/kWh-Werte aus InfluxDB (Integration/Rollups) ableiten. Nur setzen, wenn dein Datenpunkt wirklich kWh liefert (nicht Wh).",
          "placeholder": "z.B. 0_userdata.0.... (kWh Counter)"
        },
        "datapoints.consumptionEnergyKwh": {
          "type": "objectId",
          "label": "Verbrauch – Energie gesamt (kWh)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "attr": "datapoints.consumptionEnergyKwh",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true,
          "help": "Optional. Wenn leer, kann die VIS später Energie-/kWh-Werte aus InfluxDB (Integration/Rollups) ableiten. Nur setzen, wenn dein Datenpunkt wirklich kWh liefert (nicht Wh).",
          "placeholder": "z.B. 0_userdata.0.... (kWh Counter)"
        },
        "datapoints.gridEnergyKwh": {
          "type": "objectId",
          "label": "Netz – Energie gesamt (kWh)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "attr": "datapoints.gridEnergyKwh",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true,
          "help": "Optional. Wenn leer, kann die VIS später Energie-/kWh-Werte aus InfluxDB (Integration/Rollups) ableiten. Nur setzen, wenn dein Datenpunkt wirklich kWh liefert (nicht Wh).",
          "placeholder": "z.B. 0_userdata.0.... (kWh Counter)"
        },
        "datapoints.evcsLastChargeKwh": {
          "type": "objectId",
          "label": "EVCS letzte Ladung (kWh)",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "attr": "datapoints.evcsLastChargeKwh",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true,
          "help": "Optional. Wenn leer, kann die VIS später Energie-/kWh-Werte aus InfluxDB (Integration/Rollups) ableiten. Nur setzen, wenn dein Datenpunkt wirklich kWh liefert (nicht Wh).",
          "placeholder": "z.B. 0_userdata.0.... (kWh Counter)"
        }
      },
      "label": "Datenpunkte",
      "title": "Datenpunkte"
    },
    "smarthome_vorbereitet": {
      "type": "panel",
      "items": {
        "smartHome.enabled": {
          "type": "checkbox",
          "label": "SmartHome-Bereich aktivieren (Beta)",
          "attr": "smartHome.enabled",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.heatPumpOn": {
          "type": "objectId",
          "label": "Wärmepumpe EIN/AUS (bool)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.*",
          "help": "SmartHome-Datenpunkt",
          "newLine": false,
          "attr": "smartHome.datapoints.heatPumpOn",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.roomTemp": {
          "type": "objectId",
          "label": "Raumtemperatur (°C)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.*",
          "help": "SmartHome-Datenpunkt",
          "newLine": false,
          "attr": "smartHome.datapoints.roomTemp",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.rtrSetpoint": {
          "type": "objectId",
          "label": "RTR Solltemperatur (°C)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.rtr.setpoint",
          "help": "SmartHome-Datenpunkt für Solltemperatur des RTR",
          "newLine": true,
          "attr": "smartHome.datapoints.rtrSetpoint",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.rtrMode": {
          "type": "objectId",
          "label": "RTR Modus (Auto/Komfort/Nacht/...)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.rtr.mode",
          "help": "Optional: Modus des Raumtemperaturreglers (String oder Zahl)",
          "newLine": false,
          "attr": "smartHome.datapoints.rtrMode",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "smartHome.datapoints.rtrHumidity": {
          "type": "objectId",
          "label": "Raumfeuchte (%)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.rtr.humidity",
          "help": "Optional: Luftfeuchte im Raum in %",
          "newLine": true,
          "attr": "smartHome.datapoints.rtrHumidity",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "smartHome.datapoints.wallboxLock": {
          "type": "objectId",
          "label": "Wallbox verriegeln (bool)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.*",
          "help": "SmartHome-Datenpunkt",
          "newLine": false,
          "attr": "smartHome.datapoints.wallboxLock",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.gridLimit": {
          "type": "objectId",
          "label": "Netzbezugslimit (W)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.*",
          "help": "SmartHome-Datenpunkt",
          "newLine": false,
          "attr": "smartHome.datapoints.gridLimit",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.pvCurtailment": {
          "type": "objectId",
          "label": "PV-Abregelung (%)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.*",
          "help": "SmartHome-Datenpunkt",
          "newLine": false,
          "attr": "smartHome.datapoints.pvCurtailment",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.blindPosition": {
          "type": "objectId",
          "label": "Jalousie – Position (0–100 %)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.blind.position",
          "help": "SmartHome-Datenpunkt für Jalousie-Position (0 = offen, 100 = geschlossen)",
          "newLine": true,
          "attr": "smartHome.datapoints.blindPosition",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.blindUp": {
          "type": "objectId",
          "label": "Jalousie – Auf (bool)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.blind.up",
          "help": "Fahrbefehl Auf (z.B. KNX Up)",
          "newLine": false,
          "attr": "smartHome.datapoints.blindUp",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.blindDown": {
          "type": "objectId",
          "label": "Jalousie – Ab (bool)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.blind.down",
          "help": "Fahrbefehl Ab (z.B. KNX Down)",
          "newLine": true,
          "attr": "smartHome.datapoints.blindDown",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.blindStop": {
          "type": "objectId",
          "label": "Jalousie – Stop (bool)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.blind.stop",
          "help": "Stop-Befehl (optional)",
          "newLine": false,
          "attr": "smartHome.datapoints.blindStop",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "smartHome.datapoints.scene1": {
          "type": "objectId",
          "label": "Szene 1 (z.B. Wohlfühlen)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.scene.wohnen.1",
          "help": "Datenpunkt für Szene 1 (bool / Taster)",
          "newLine": true,
          "attr": "smartHome.datapoints.scene1",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.scene2": {
          "type": "objectId",
          "label": "Szene 2 (z.B. Alles aus)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.scene.wohnen.2",
          "help": "Datenpunkt für Szene 2 (bool / Taster)",
          "newLine": false,
          "attr": "smartHome.datapoints.scene2",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "smartHome.datapoints.scene3": {
          "type": "objectId",
          "label": "Szene 3",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.scene.wohnen.3",
          "help": "Optional: weitere Szene",
          "newLine": true,
          "attr": "smartHome.datapoints.scene3",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        },
        "smartHome.datapoints.scene4": {
          "type": "objectId",
          "label": "Szene 4",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "z.B. 0_userdata.0.nexowatt.smarthome.scene.wohnen.4",
          "help": "Optional: weitere Szene",
          "newLine": false,
          "attr": "smartHome.datapoints.scene4",
          "xs": 12,
          "sm": 12,
          "md": 6,
          "expert": true
        }
      },
      "label": "SmartHome (vorbereitet)",
      "title": "SmartHome (vorbereitet)",
      "hidden": true
    },
    "erweitert___zukunft": {
      "type": "panel",
      "items": {
        "futureOptions.theme": {
          "type": "select",
          "label": "Theme",
          "options": [
            {
              "label": "NexoWatt Dark",
              "value": "nexowatt-dark"
            },
            {
              "label": "NexoWatt Light (später)",
              "value": "nexowatt-light"
            }
          ],
          "attr": "futureOptions.theme",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "futureOptions.enableAnimations": {
          "type": "checkbox",
          "label": "Animationen aktivieren",
          "attr": "futureOptions.enableAnimations",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "futureOptions.showGridVoltage": {
          "type": "checkbox",
          "label": "Netzspannung anzeigen (experimentell)",
          "attr": "futureOptions.showGridVoltage",
          "xs": 12,
          "sm": 12,
          "md": 6
        }
      },
      "label": "Erweitert / Zukunft",
      "title": "Erweitert / Zukunft"
    },
    "installateur": {
      "type": "panel",
      "label": "§14a",
      "title": "§14a",
      "items": {
        "installerInfo": {
          "type": "header",
          "text": "§14a‑Einstellungen (EnWG) – steuerbare Verbrauchseinrichtungen. Ladepunkte (EVCS) werden im §14a‑Fall automatisch berücksichtigt; zusätzliche Verbraucher kannst du unten eintragen. Zentrale Anlagenparameter (z. B. Netzanschlussleistung / Gate‑A‑Sicherheitskappe) stellst du im Reiter „EMS“ ein.",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "para14aHeader": {
          "type": "header",
          "text": "§14a EnWG – Steuerbare Verbrauchseinrichtungen (z. B. Wallbox, Wärmepumpe, Klimagerät). Aktiviert die interne §14a‑Logik. Ladepunkte (EVCS) werden automatisch berücksichtigt; zusätzliche Verbraucher können unten eingetragen werden.",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "installerConfig.para14a": {
          "type": "checkbox",
          "label": "§14a‑Logik aktivieren",
          "attr": "installerConfig.para14a",
          "xs": 12,
          "sm": 6,
          "md": 6
        },
        "installerConfig.para14aMode": {
          "type": "select",
          "label": "§14a Modus",
          "options": [
            {
              "label": "Direktansteuerung (4,2 kW je Verbraucher)",
              "value": "direct"
            },
            {
              "label": "Steuerung mittels EMS (Pmin,14a / GZF)",
              "value": "ems"
            }
          ],
          "default": "direct",
          "attr": "installerConfig.para14aMode",
          "hidden": "!data.installerConfig || !data.installerConfig.para14a",
          "xs": 12,
          "sm": 6,
          "md": 6
        },
        "installerConfig.para14aMinPerDeviceW": {
          "type": "number",
          "label": "Mindestleistung je Verbraucher (W)",
          "min": 0,
          "default": 4200,
          "attr": "installerConfig.para14aMinPerDeviceW",
          "hidden": "!data.installerConfig || !data.installerConfig.para14a",
          "xs": 12,
          "sm": 6,
          "md": 6
        },
        "installerConfig.para14aActiveId": {
          "type": "objectId",
          "label": "§14a Aktiv‑Signal (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "Objekt auswählen … (0/1 oder true/false)",
          "help": "Optional: Wenn gesetzt, wird §14a nur dann wirksam, wenn dieser Datenpunkt aktiv ist. Wenn leer, gilt '§14a‑Logik aktivieren' als immer aktiv.",
          "attr": "installerConfig.para14aActiveId",
          "hidden": "!data.installerConfig || !data.installerConfig.para14a",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "expert": true
        },
        "installerConfig.para14aEmsSetpointWId": {
          "type": "objectId",
          "label": "EMS‑Sollwert (W) vom Netzbetreiber (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "placeholder": "Objekt auswählen … (W)",
          "help": "Optional: Gesamt‑Sollwert (W) für alle §14a‑Verbraucher (Steuerung mittels EMS). Wenn leer, nutzt der Adapter den internen Mindestwert (Pmin,14a).",
          "attr": "installerConfig.para14aEmsSetpointWId",
          "hidden": "!data.installerConfig || !data.installerConfig.para14a || data.installerConfig.para14aMode !== 'ems'",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "expert": true
        },
        "installerConfig.para14aConsumers": {
          "type": "table",
          "label": "§14a Verbraucher (zusätzlich zu Ladepunkten)",
          "help": "Hier trägst du zusätzliche steuerbare Verbraucher ein, die im §14a‑Fall gedrosselt werden sollen (z. B. Wärmepumpe, Heizstab, Klimagerät). Ladepunkte (EVCS) werden automatisch berücksichtigt. Die zentrale Netzanschlussleistung wird im Reiter „EMS“ konfiguriert.",
          "attr": "installerConfig.para14aConsumers",
          "hidden": "!data.installerConfig || !data.installerConfig.para14a",
          "items": [
            {
              "type": "checkbox",
              "label": "Aktiv",
              "attr": "enabled",
              "title": "Aktiv",
              "xs": 3,
              "sm": 2,
              "md": 1
            },
            {
              "type": "select",
              "label": "Typ",
              "attr": "type",
              "title": "Typ",
              "xs": 9,
              "sm": 4,
              "md": 2,
              "options": [
                {
                  "label": "Wärmepumpe",
                  "value": "heatPump"
                },
                {
                  "label": "Heizstab",
                  "value": "heatingRod"
                },
                {
                  "label": "Klimagerät",
                  "value": "airCondition"
                },
                {
                  "label": "Speicher (optional)",
                  "value": "storage"
                },
                {
                  "label": "Sonstiges",
                  "value": "custom"
                }
              ]
            },
            {
              "type": "text",
              "label": "Name",
              "attr": "name",
              "title": "Name",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "style": {
                "minWidth": "160px"
              }
            },
            {
              "type": "number",
              "label": "Netzanschlussleistung (W)",
              "attr": "installedPowerW",
              "title": "Netzanschlussleistung (W)",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "min": 0,
              "tooltip": "Für EMS‑Formel: Summe je Kategorie. Wird außerdem als Normalwert zur Aufhebung der Drosselung genutzt."
            },
            {
              "type": "select",
              "label": "Ansteuerung",
              "attr": "controlType",
              "title": "Ansteuerung",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "options": [
                {
                  "label": "Leistungslimit (W)",
                  "value": "limitW"
                },
                {
                  "label": "Sperren (Ein/Aus)",
                  "value": "onOff"
                }
              ]
            },
            {
              "type": "objectId",
              "label": "Sollwert‑DP (W)",
              "attr": "setPowerWId",
              "title": "Sollwert‑DP (W)",
              "types": [
                "state"
              ],
              "showName": true,
              "xs": 12,
              "sm": 12,
              "md": 4,
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "340px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "tooltip": "Datenpunkt, auf den das Leistungs‑Limit (W) geschrieben wird."
            },
            {
              "type": "objectId",
              "label": "Enable‑DP (optional)",
              "attr": "enableId",
              "title": "Enable‑DP (optional)",
              "types": [
                "state"
              ],
              "showName": true,
              "xs": 12,
              "sm": 12,
              "md": 4,
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "340px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "tooltip": "Optionaler Enable/Sperr‑Datenpunkt. Bei 'Sperren (Ein/Aus)' wird dieser verwendet.",
              "expert": true
            },
            {
              "type": "number",
              "label": "Priorität",
              "attr": "priority",
              "title": "Priorität",
              "xs": 6,
              "sm": 4,
              "md": 2,
              "min": 1,
              "max": 999,
              "tooltip": "Kleinere Zahl = höhere Priorität (wird u. a. für die EMS‑Verteilung genutzt)."
            }
          ]
        }
      }
    },
    "ems": {
      "type": "panel",
      "label": "EMS",
      "title": "EMS",
      "items": {
        "emsInfo": {
          "type": "header",
          "text": "EMS‑Module im VIS‑Adapter (Multiuse‑Engine). Hier aktivierst du die Module (Charging / Peak‑Shaving / Netz‑Constraints / Speicher) und stellst den Scheduler‑Takt ein. Sobald du ein Modul aktivierst, wird der jeweilige EMS‑Reiter sichtbar und dort konfiguriert.",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "emsAppCenterLink": {
          "type": "staticText",
          "text": "App‑Center öffnen: Im Adapter‑Reiter \"Tab\" auf \"EMS Apps öffnen\" klicken. Oder direkt aus dem Admin: /adapter/nexowatt-vis/appcenter.html?instance=<INSTANZ>. Alternativ direkt per Port: http://<HOST>:<PORT>/ems-apps.html (Port siehe \"Allgemein\" → Webserver‑Port).",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "plantParamsHeader": {
          "type": "header",
          "text": "Zentrale Anlagenparameter (wirken auf alle EMS‑Module). Die Netzanschlussleistung wird als harte Sicherheitskappe (Gate A) genutzt, z. B. zur Begrenzung des Ladebudgets.",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "installerConfig.gridConnectionPower": {
          "type": "number",
          "label": "Netzanschlussleistung (W)",
          "min": 0,
          "attr": "installerConfig.gridConnectionPower",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "help": "Zentrales Limit am Netzanschlusspunkt. Wird u. a. für Gate‑A‑Sicherheitskappen im Charging‑Management genutzt."
        },
        "schedulerIntervalMs": {
          "type": "number",
          "label": "Scheduler‑Intervall (ms)",
          "min": 250,
          "max": 10000,
          "step": 50,
          "default": 1000,
          "attr": "schedulerIntervalMs",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "help": "Takt der EMS‑Regelung. Typisch 1000 ms."
        },
        "enableChargingManagement": {
          "type": "checkbox",
          "label": "Charging‑Management aktiv",
          "default": true,
          "attr": "enableChargingManagement",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "help": "Wenn aktiv, schreibt der Adapter Setpoints (A/W) für die konfigurierten Ladepunkte. Deaktivieren = keine Setpoints."
        },
        "enablePeakShaving": {
          "type": "checkbox",
          "label": "Lastspitzenkappung (Peak Shaving) aktiv",
          "default": false,
          "attr": "enablePeakShaving",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "help": "Begrenzt Netzbezug (Import) und kann das Ladebudget automatisch reduzieren."
        },
        "enableGridConstraints": {
          "type": "checkbox",
          "label": "Grid‑Constraints aktiv (optional)",
          "default": false,
          "attr": "enableGridConstraints",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        },
        "enableStorageControl": {
          "type": "checkbox",
          "label": "Speicher‑Regelung aktiv (optional)",
          "default": false,
          "attr": "enableStorageControl",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        },
        "enableStorageFarm": {
          "type": "checkbox",
          "label": "Speicherfarm aktiv (optional)",
          "default": false,
          "attr": "enableStorageFarm",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "help": "Aktiviert die Speicherfarm-Funktion (mehrere Speichersysteme als Pool oder gruppiert). Nach dem Speichern erscheint der Admin-Reiter „EMS – Speicherfarm“ sowie im VIS-Frontend der Reiter „Speicherfarm“.",
          "expert": true,
          "expertMode": true
        },
        "diagnostics.enabled": {
          "type": "checkbox",
          "label": "Diagnose aktiv",
          "default": false,
          "attr": "diagnostics.enabled",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        },
        "diagnostics.writeStates": {
          "type": "checkbox",
          "label": "Diagnose‑States schreiben",
          "default": true,
          "attr": "diagnostics.writeStates",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        },
        "diagnostics.logLevel": {
          "type": "select",
          "label": "Diagnose Log‑Level",
          "attr": "diagnostics.logLevel",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "options": [
            {
              "label": "debug",
              "value": "debug"
            },
            {
              "label": "info",
              "value": "info"
            }
          ],
          "default": "debug",
          "expert": true,
          "expertMode": true
        },
        "diagnostics.logIntervalSec": {
          "type": "number",
          "label": "Diagnose Log‑Intervall (s)",
          "min": 0,
          "max": 3600,
          "step": 1,
          "default": 10,
          "attr": "diagnostics.logIntervalSec",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        },
        "diagnostics.stateIntervalSec": {
          "type": "number",
          "label": "Diagnose State‑Intervall (s)",
          "min": 0,
          "max": 3600,
          "step": 1,
          "default": 10,
          "attr": "diagnostics.stateIntervalSec",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        },
        "diagnostics.maxJsonLen": {
          "type": "number",
          "label": "Diagnose max JSON Länge",
          "min": 1000,
          "max": 500000,
          "step": 1000,
          "default": 20000,
          "attr": "diagnostics.maxJsonLen",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        }
      }
    },
    "ems_charging": {
      "type": "panel",
      "label": "EMS – Charging",
      "title": "EMS – Charging (Ladepunkte / Budgets)",
      "items": {
        "cmInfo": {
          "type": "header",
          "text": "Hier stellst du die globale Charging‑Logik ein (Budget‑Modus, PV‑Quelle, Verhalten bei Peak‑Shaving, Stationen‑Fairness). Pro Ladepunkt steuerst du den Modus zur Laufzeit über chargingManagement.wallboxes.*.userMode.",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "chargingManagement.mode": {
          "type": "select",
          "label": "Charging‑Modus",
          "attr": "chargingManagement.mode",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "options": [
            {
              "label": "off (keine Regelung)",
              "value": "off"
            },
            {
              "label": "pvSurplus (nur Überschuss)",
              "value": "pvSurplus"
            },
            {
              "label": "mixed (Standard)",
              "value": "mixed"
            }
          ],
          "default": "mixed",
          "help": "Hinweis: Für die Praxis nutzt du meist 'mixed' + pro Ladepunkt userMode (auto/pv/minpv/boost)."
        },
        "chargingManagement.totalBudgetMode": {
          "type": "select",
          "label": "Gesamt‑Budget Modus",
          "attr": "chargingManagement.totalBudgetMode",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "options": [
            {
              "label": "engine (empfohlen)",
              "value": "engine"
            },
            {
              "label": "unlimited",
              "value": "unlimited"
            },
            {
              "label": "static",
              "value": "static"
            },
            {
              "label": "fromDatapoint (VIS/Script)",
              "value": "fromDatapoint"
            },
            {
              "label": "fromPeakShaving",
              "value": "fromPeakShaving"
            }
          ],
          "default": "engine",
          "help": "engine = kombiniert static + PeakShaving + optional Datapoint‑Budget. Für VIS‑Schalter eignet sich fromDatapoint.",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.staticMaxChargingPowerW": {
          "type": "number",
          "label": "Static Max Charging Power (W)",
          "attr": "chargingManagement.staticMaxChargingPowerW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 11000,
          "min": 0,
          "max": 10000000,
          "step": 50,
          "help": "Nur relevant bei Budget‑Modus engine/static. 0 = kein Limit."
        },
        "chargingManagement.budgetPowerId": {
          "type": "objectId",
          "label": "Budget‑DP (W) (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "chargingManagement.budgetPowerId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Wenn Budget‑Modus fromDatapoint oder engine: dieser Datenpunkt begrenzt das Gesamt‑Ladebudget.",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.gridPowerId": {
          "type": "objectId",
          "label": "Netzleistung‑DP (W) (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "chargingManagement.gridPowerId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Optional: Netto‑Netzleistung (Import + / Export −). Wird für PV‑Überschuss‑Logik benötigt, wenn du keinen PV‑Surplus‑DP nutzt.",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.pvSurplusPowerId": {
          "type": "objectId",
          "label": "PV‑Überschuss‑DP (W) (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "chargingManagement.pvSurplusPowerId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Optional: echter Überschuss‑Datenpunkt. Wenn leer, wird aus Netzleistung abgeleitet (sofern vorhanden).",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.stationAllocationMode": {
          "type": "select",
          "label": "Stations‑Verteilung (DC‑Stationen)",
          "attr": "chargingManagement.stationAllocationMode",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "options": [
            {
              "label": "sequential (wie bisher)",
              "value": "sequential"
            },
            {
              "label": "roundRobin (fair, ohne Boost‑Connector)",
              "value": "roundRobin"
            }
          ],
          "default": "sequential",
          "help": "Bei Stationsgruppen: roundRobin rotiert die Reihenfolge der nicht‑Boost‑Connectors pro Tick, damit niemand dauerhaft verhungert.",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.boostTimeoutMinDc": {
          "type": "number",
          "label": "Boost Timeout DC (min)",
          "attr": "chargingManagement.boostTimeoutMinDc",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 60,
          "min": 0,
          "max": 1000000,
          "step": 1,
          "help": "Maximale Boost‑Dauer für DC‑Ladepunkte. 0 = kein Auto‑Timeout.",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.boostTimeoutMinAc": {
          "type": "number",
          "label": "Boost Timeout AC (min)",
          "attr": "chargingManagement.boostTimeoutMinAc",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 300,
          "min": 0,
          "max": 1000000,
          "step": 1,
          "help": "Maximale Boost‑Dauer für AC‑Ladepunkte. 0 = kein Auto‑Timeout.",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.storageAssistHeader": {
          "type": "header",
          "text": "Gate C – Speicher-Unterstützung für Laden",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.storageAssistEnabled": {
          "type": "checkbox",
          "label": "Speicher-Unterstützung aktivieren",
          "attr": "chargingManagement.storageAssistEnabled",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": false,
          "help": "Wenn aktiv, kann das EMS bei hohem Speicher-SoC zusätzliche Ladeleistung über Batterie-Entladung bereitstellen, ohne das Netz-Import-Limit zu überlasten (Gate C). Voraussetzung: Speicher-SoC und Speicher-Sollleistung-DP sind im Tab EMS – Speicher gemappt."
        },
        "chargingManagement.storageAssistApply": {
          "type": "select",
          "label": "Anwendung",
          "attr": "chargingManagement.storageAssistApply",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "options": [
            {
              "label": "nur Boost",
              "value": "boostOnly"
            },
            {
              "label": "Boost und Auto",
              "value": "boostAndAuto"
            }
          ],
          "default": "boostOnly",
          "help": "Definiert, in welchen Betriebsmodi Speicher-Unterstützung aktiv sein darf."
        },
        "chargingManagement.storageAssistStartSocPct": {
          "type": "number",
          "label": "Start-SoC (%)",
          "attr": "chargingManagement.storageAssistStartSocPct",
          "xs": 12,
          "sm": 4,
          "md": 4,
          "min": 0,
          "max": 100,
          "default": 60,
          "help": "Ab diesem SoC beginnt die Speicher-Unterstützung (Hysterese-Start)."
        },
        "chargingManagement.storageAssistStopSocPct": {
          "type": "number",
          "label": "Stop-SoC (%)",
          "attr": "chargingManagement.storageAssistStopSocPct",
          "xs": 12,
          "sm": 4,
          "md": 4,
          "min": 0,
          "max": 100,
          "default": 40,
          "help": "Unterhalb dieses SoC endet die Speicher-Unterstützung (Hysterese-Stop)."
        },
        "chargingManagement.storageAssistMaxDischargeW": {
          "type": "number",
          "label": "Max. Entladeleistung (W)",
          "attr": "chargingManagement.storageAssistMaxDischargeW",
          "xs": 12,
          "sm": 4,
          "md": 4,
          "min": 0,
          "max": 1000000,
          "default": 0,
          "help": "0 = automatisch (Storage.maxDischargeW). Sonst maximale Entladeleistung, die zur Ladepark-Unterstützung genutzt werden darf."
        },
        "chargingManagement.pauseWhenPeakShavingActive": {
          "type": "checkbox",
          "label": "Bei Peak‑Shaving pausieren",
          "attr": "chargingManagement.pauseWhenPeakShavingActive",
          "default": true,
          "xs": 12,
          "sm": 6,
          "md": 6,
          "help": "Wenn Peak‑Shaving aktiv ist, kann Charging automatisch pausiert werden.",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.pauseBehavior": {
          "type": "select",
          "label": "Pause‑Verhalten",
          "attr": "chargingManagement.pauseBehavior",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "options": [
            {
              "label": "rampDownToZero (sicher)",
              "value": "rampDownToZero"
            },
            {
              "label": "followPeakBudget",
              "value": "followPeakBudget"
            }
          ],
          "default": "rampDownToZero",
          "help": "rampDownToZero = Setpoints auf 0. followPeakBudget = Budget folgt Peak‑Budget (wenn verfügbar).",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.staleTimeoutSec": {
          "type": "number",
          "label": "Stale Timeout (s)",
          "attr": "chargingManagement.staleTimeoutSec",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 15,
          "min": 1,
          "max": 3600,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.activityThresholdW": {
          "type": "number",
          "label": "Activity Threshold (W)",
          "attr": "chargingManagement.activityThresholdW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 200,
          "min": 0,
          "max": 1000000,
          "step": 10,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.stopGraceSec": {
          "type": "number",
          "label": "Stop Grace (s)",
          "attr": "chargingManagement.stopGraceSec",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 30,
          "min": 0,
          "max": 3600,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.sessionKeepSec": {
          "type": "number",
          "label": "Session Keep (s)",
          "attr": "chargingManagement.sessionKeepSec",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 300,
          "min": 0,
          "max": 86400,
          "step": 10,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.pvStartThresholdW": {
          "type": "number",
          "label": "PV Start (W)",
          "attr": "chargingManagement.pvStartThresholdW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 800,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "help": "PV‑Modi starten erst, wenn PV‑Überschuss ≥ Start‑Schwelle (Anti‑Flattern). 0 = jede positive PV.",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.pvStopThresholdW": {
          "type": "number",
          "label": "PV Stop (W)",
          "attr": "chargingManagement.pvStopThresholdW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 200,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "help": "PV‑Modi werden gestoppt, wenn PV‑Überschuss ≤ Stop‑Schwelle (Hysterese).",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.pvStartDelaySec": {
          "type": "number",
          "label": "PV Start Delay (s)",
          "attr": "chargingManagement.pvStartDelaySec",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 10,
          "min": 0,
          "max": 3600,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.pvStopDelaySec": {
          "type": "number",
          "label": "PV Stop Delay (s)",
          "attr": "chargingManagement.pvStopDelaySec",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 30,
          "min": 0,
          "max": 3600,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.pvAbortImportW": {
          "type": "number",
          "label": "PV Abort bei Netzbezug (W)",
          "attr": "chargingManagement.pvAbortImportW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 200,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "help": "Wenn Netzbezug > Abort‑Schwelle während PV‑Modi: PV wird als nicht verfügbar behandelt (Sicherheits‑Stop).",
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.stepA": {
          "type": "number",
          "label": "Step A",
          "attr": "chargingManagement.stepA",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0.1,
          "min": 0,
          "max": 100,
          "step": 0.1,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.stepW": {
          "type": "number",
          "label": "Step W",
          "attr": "chargingManagement.stepW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 25,
          "min": 0,
          "max": 100000,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.maxDeltaAPerTick": {
          "type": "number",
          "label": "Max ΔA/Tick",
          "attr": "chargingManagement.maxDeltaAPerTick",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 1000,
          "step": 0.1,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.maxDeltaWPerTick": {
          "type": "number",
          "label": "Max ΔW/Tick",
          "attr": "chargingManagement.maxDeltaWPerTick",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 1000000,
          "step": 10,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.acMinPower3pW": {
          "type": "number",
          "label": "AC Min Power 3‑ph (W)",
          "attr": "chargingManagement.acMinPower3pW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 4200,
          "min": 0,
          "max": 100000,
          "step": 50,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.voltageV": {
          "type": "number",
          "label": "Spannung Default (V)",
          "attr": "chargingManagement.voltageV",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 230,
          "min": 50,
          "max": 1000,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "chargingManagement.defaultPhases": {
          "type": "select",
          "label": "Default Phasen",
          "attr": "chargingManagement.defaultPhases",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "options": [
            {
              "label": "1",
              "value": 1
            },
            {
              "label": "3",
              "value": 3
            }
          ],
          "default": 3,
          "expert": true,
          "expertMode": true
        }
      },
      "hidden": "data.enableChargingManagement === false"
    },
    "ems_peak": {
      "type": "panel",
      "label": "EMS – Peak Shaving",
      "title": "EMS – Peak Shaving (Lastspitzenkappung)",
      "items": {
        "psInfo": {
          "type": "header",
          "text": "Peak‑Shaving begrenzt den Netzbezug (Import). Die Netzpunktleistung (NVP) kommt standardmäßig aus „Datenpunkte“ (Netto oder aus Bezug/Einspeisung). Aktivierung erfolgt im EMS‑Tab; der Reiter erscheint dann automatisch.",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "peakShaving.mode": {
          "type": "select",
          "label": "Modus",
          "attr": "peakShaving.mode",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "options": [
            {
              "label": "static (fester Grenzwert)",
              "value": "static"
            },
            {
              "label": "dynamic (Grenzwert aus Datenpunkt)",
              "value": "dynamic"
            }
          ],
          "default": "static"
        },
        "peakShaving.gridPointPowerId": {
          "type": "objectId",
          "label": "Netzleistung (W) – Import + / Export −",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "peakShaving.gridPointPowerId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Optionaler Override. Standard: Das EMS nutzt die Netzpunktleistung (NVP) aus „Datenpunkte“ (Netto oder aus Bezug/Einspeisung abgeleitet) und stellt sie intern als ems.gridPowerW bereit.",
          "expert": true,
          "expertMode": true
        },
        "peakShaving.allowedPowerId": {
          "type": "objectId",
          "label": "Erlaubte Import‑Leistung DP (W) (dynamic)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "peakShaving.allowedPowerId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Nur im dynamic‑Modus: Externer DP, der den erlaubten Import‑Grenzwert liefert.",
          "expert": true,
          "expertMode": true
        },
        "psLimitInfo": {
          "type": "staticText",
          "text": "Grenzwert (Netzanschlussleistung) wird zentral unter \"EMS\" gepflegt und von Peak‑Shaving automatisch verwendet. Optional kann im dynamic‑Modus ein externer DP (\"Erlaubte Import‑Leistung\") den Grenzwert zusätzlich reduzieren.",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "peakShaving.reserveW": {
          "type": "number",
          "label": "Reserve (W)",
          "attr": "peakShaving.reserveW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "help": "Vorbeugende Reserve: Peak‑Shaving beginnt bereits bei (Netzanschlussleistung − Reserve), um Lastsprünge abzufangen.",
          "expert": true,
          "expertMode": true
        },
        "peakShaving.safetyMarginW": {
          "type": "number",
          "label": "Safety‑Margin (W)",
          "attr": "peakShaving.safetyMarginW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "expert": true,
          "expertMode": true
        },
        "peakShaving.smoothingSeconds": {
          "type": "number",
          "label": "Glättung (s)",
          "attr": "peakShaving.smoothingSeconds",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 10,
          "min": 1,
          "max": 600,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "peakShaving.useAverage": {
          "type": "checkbox",
          "label": "Average/Glättung nutzen",
          "attr": "peakShaving.useAverage",
          "default": true,
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        },
        "peakShaving.hysteresisW": {
          "type": "number",
          "label": "Hysterese (W)",
          "attr": "peakShaving.hysteresisW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 500,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "expert": true,
          "expertMode": true
        },
        "peakShaving.activateDelaySeconds": {
          "type": "number",
          "label": "Aktivierungs‑Delay (s)",
          "attr": "peakShaving.activateDelaySeconds",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 2,
          "min": 0,
          "max": 3600,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "peakShaving.releaseDelaySeconds": {
          "type": "number",
          "label": "Release‑Delay (s)",
          "attr": "peakShaving.releaseDelaySeconds",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 5,
          "min": 0,
          "max": 3600,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "peakShaving.baseLoadPowerId": {
          "type": "objectId",
          "label": "Basislast DP (W) (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "peakShaving.baseLoadPowerId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Optional: Haus‑Basislast (für Diagnose/Logik).",
          "expert": true,
          "expertMode": true
        },
        "peakShaving.pvPowerId": {
          "type": "objectId",
          "label": "PV‑Leistung DP (W) (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "peakShaving.pvPowerId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Optional: PV‑Istleistung (für Diagnose/Logik).",
          "expert": true,
          "expertMode": true
        },
        "peakShaving.batteryPowerId": {
          "type": "objectId",
          "label": "Batterie‑Leistung DP (W) (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "peakShaving.batteryPowerId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Optional: Speicher‑Istleistung (für Diagnose/Logik).",
          "expert": true,
          "expertMode": true
        }
      },
      "hidden": "!data.enablePeakShaving"
    },
    "ems_grid": {
      "type": "panel",
      "label": "EMS – Netz‑Constraints",
      "title": "EMS – Netz‑Constraints (RLM / Nulleinspeisung)",
      "items": {
        "gcInfo": {
          "type": "header",
          "text": "Grid‑Constraints: RLM (15‑min Demand) und Nulleinspeisung (PV‑Curtail). Aktivierung erfolgt im EMS‑Tab.",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "gridConstraints.gridPowerId": {
          "type": "objectId",
          "label": "Netzleistung‑DP (W) (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "gridConstraints.gridPowerId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Optionaler Override. Standard: Das EMS nutzt die Netzpunktleistung (NVP) aus „Datenpunkte“ und stellt sie intern als grid.powerW/ems.gridPowerW bereit.",
          "expert": true,
          "expertMode": true
        },
        "gridConstraints.staleTimeoutSec": {
          "type": "number",
          "label": "Stale Timeout (s)",
          "attr": "gridConstraints.staleTimeoutSec",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 15,
          "min": 1,
          "max": 3600,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "gcRlmHeader": {
          "type": "header",
          "text": "RLM (15‑min Durchschnitt)",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "gridConstraints.rlmEnabled": {
          "type": "checkbox",
          "label": "RLM aktiv",
          "attr": "gridConstraints.rlmEnabled",
          "default": false,
          "xs": 12,
          "sm": 6,
          "md": 6
        },
        "gridConstraints.rlmLimitW": {
          "type": "number",
          "label": "RLM Limit (W)",
          "attr": "gridConstraints.rlmLimitW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 10000000,
          "step": 100,
          "help": "0 = aus. Setzt den 15‑min Durchschnitts‑Grenzwert."
        },
        "gridConstraints.rlmSafetyMarginW": {
          "type": "number",
          "label": "Safety‑Margin (W)",
          "attr": "gridConstraints.rlmSafetyMarginW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "expert": true,
          "expertMode": true
        },
        "gridConstraints.rlmAligned": {
          "type": "checkbox",
          "label": "RLM an Viertelstunden ausrichten",
          "attr": "gridConstraints.rlmAligned",
          "default": true,
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        },
        "gcZeroHeader": {
          "type": "header",
          "text": "Nulleinspeisung (Zero Export)",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "gridConstraints.zeroExportEnabled": {
          "type": "checkbox",
          "label": "Nulleinspeisung aktiv",
          "attr": "gridConstraints.zeroExportEnabled",
          "default": false,
          "xs": 12,
          "sm": 6,
          "md": 6
        },
        "gridConstraints.zeroExportBiasW": {
          "type": "number",
          "label": "Import‑Bias (W)",
          "attr": "gridConstraints.zeroExportBiasW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 80,
          "min": 0,
          "max": 10000,
          "step": 10,
          "help": "Ziel ist leicht positiver Import (verhindert Export‑Flattern).",
          "expert": true,
          "expertMode": true
        },
        "gridConstraints.zeroExportDeadbandW": {
          "type": "number",
          "label": "Deadband (W)",
          "attr": "gridConstraints.zeroExportDeadbandW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 50,
          "min": 0,
          "max": 5000,
          "step": 10,
          "expert": true,
          "expertMode": true
        },
        "gcPvHeader": {
          "type": "header",
          "text": "PV‑Curtail (Wechselrichter‑Limit)",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "gridConstraints.pvCurtailMode": {
          "type": "select",
          "label": "Curtail‑Modus",
          "attr": "gridConstraints.pvCurtailMode",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "options": [
            {
              "label": "auto",
              "value": "auto"
            },
            {
              "label": "off",
              "value": "off"
            },
            {
              "label": "feedInLimitW (Einspeiselimit)",
              "value": "feedInLimitW"
            },
            {
              "label": "pvLimitW (PV Limit W)",
              "value": "pvLimitW"
            },
            {
              "label": "pvLimitPct (PV Limit %)",
              "value": "pvLimitPct"
            }
          ],
          "default": "auto",
          "expert": true,
          "expertMode": true
        },
        "gridConstraints.pvFeedInLimitWId": {
          "type": "objectId",
          "label": "Einspeise‑Limit‑DP (W) (write)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "gridConstraints.pvFeedInLimitWId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "expert": true,
          "expertMode": true
        },
        "gridConstraints.pvLimitWId": {
          "type": "objectId",
          "label": "PV‑Limit‑DP (W) (write)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "gridConstraints.pvLimitWId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "expert": true,
          "expertMode": true
        },
        "gridConstraints.pvLimitPctId": {
          "type": "objectId",
          "label": "PV‑Limit‑DP (%) (write)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "gridConstraints.pvLimitPctId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "expert": true,
          "expertMode": true
        },
        "gridConstraints.pvRatedPowerWId": {
          "type": "objectId",
          "label": "PV Nennleistung‑DP (W) (read)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "gridConstraints.pvRatedPowerWId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "expert": true,
          "expertMode": true
        },
        "gridConstraints.pvCurtailFastTripExportW": {
          "type": "number",
          "label": "Fast‑Trip Export (W)",
          "attr": "gridConstraints.pvCurtailFastTripExportW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 500,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "expert": true,
          "expertMode": true
        },
        "gridConstraints.pvCurtailMaxDeltaWPerTick": {
          "type": "number",
          "label": "Max ΔW/Tick (Curtail)",
          "attr": "gridConstraints.pvCurtailMaxDeltaWPerTick",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 8000,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "expert": true,
          "expertMode": true
        },
        "gridConstraints.pvCurtailMaxDeltaPctPerTick": {
          "type": "number",
          "label": "Max Δ%/Tick (Curtail)",
          "attr": "gridConstraints.pvCurtailMaxDeltaPctPerTick",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 10,
          "min": 0,
          "max": 100,
          "step": 1,
          "expert": true,
          "expertMode": true
        }
      },
      "hidden": "!data.enableGridConstraints"
    },
    "ems_storage": {
      "type": "panel",
      "label": "EMS – Speicher",
      "title": "EMS – Speicher (Mapping & Regelung)",
      "items": {
        "stInfo": {
          "type": "header",
          "text": "Speicher‑Mapping (Datenpunkte) und Regelung. Aktivierung erfolgt im EMS‑Tab. In dieser Stufe wird primär Sollleistung (W) geschrieben.",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "storage.controlMode": {
          "type": "select",
          "label": "Steuerungsart",
          "attr": "storage.controlMode",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "options": [
            {
              "label": "targetPower (Sollleistung W)",
              "value": "targetPower"
            }
          ],
          "default": "targetPower",
          "expert": true,
          "expertMode": true
        },
        "storage.staleTimeoutSec": {
          "type": "number",
          "label": "Stale Timeout (s)",
          "attr": "storage.staleTimeoutSec",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 15,
          "min": 1,
          "max": 3600,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "stMapHeader": {
          "type": "header",
          "text": "Datenpunkt‑Zuordnung",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "storage.datapoints.socObjectId": {
          "type": "objectId",
          "label": "SoC‑DP (%)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "storage.datapoints.socObjectId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Optionaler Override. Wenn leer, nutzt der Adapter automatisch „Datenpunkte → Batterie – SoC (%)“. Nur setzen, wenn du für die EMS‑Speicherlogik einen anderen SoC‑Datenpunkt verwenden willst.",
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.socScale": {
          "type": "number",
          "label": "SoC Scale",
          "attr": "storage.datapoints.socScale",
          "xs": 12,
          "sm": 6,
          "md": 4,
          "default": 1,
          "min": 0,
          "max": 100,
          "step": 0.01,
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.batteryPowerObjectId": {
          "type": "objectId",
          "label": "Ist‑Leistung‑DP (W) (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "storage.datapoints.batteryPowerObjectId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.batteryPowerScale": {
          "type": "number",
          "label": "Ist‑Leistung Scale",
          "attr": "storage.datapoints.batteryPowerScale",
          "xs": 12,
          "sm": 6,
          "md": 4,
          "default": 1,
          "min": 0,
          "max": 1000,
          "step": 0.01,
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.batteryPowerInvert": {
          "type": "checkbox",
          "label": "Ist‑Leistung invert",
          "attr": "storage.datapoints.batteryPowerInvert",
          "default": false,
          "xs": 12,
          "sm": 6,
          "md": 4,
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.targetPowerObjectId": {
          "type": "objectId",
          "label": "Soll‑Leistung‑DP (W) (write)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "storage.datapoints.targetPowerObjectId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "help": "Sollleistung‑Datenpunkt (write)."
        },
        "storage.datapoints.targetPowerScale": {
          "type": "number",
          "label": "Soll‑Leistung Scale",
          "attr": "storage.datapoints.targetPowerScale",
          "xs": 12,
          "sm": 6,
          "md": 4,
          "default": 1,
          "min": 0,
          "max": 1000,
          "step": 0.01,
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.targetPowerInvert": {
          "type": "checkbox",
          "label": "Soll‑Leistung invert",
          "attr": "storage.datapoints.targetPowerInvert",
          "default": false,
          "xs": 12,
          "sm": 6,
          "md": 4,
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.maxChargeObjectId": {
          "type": "objectId",
          "label": "Max‑Ladeleistung‑DP (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "storage.datapoints.maxChargeObjectId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.maxDischargeObjectId": {
          "type": "objectId",
          "label": "Max‑Entladeleistung‑DP (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "storage.datapoints.maxDischargeObjectId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.chargeEnableObjectId": {
          "type": "objectId",
          "label": "Laden erlaubt‑DP (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "storage.datapoints.chargeEnableObjectId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.dischargeEnableObjectId": {
          "type": "objectId",
          "label": "Entladen erlaubt‑DP (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "storage.datapoints.dischargeEnableObjectId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "expert": true,
          "expertMode": true
        },
        "storage.datapoints.reserveSocObjectId": {
          "type": "objectId",
          "label": "Reserve‑SoC‑DP (optional)",
          "types": [
            "state"
          ],
          "button": true,
          "attr": "storage.datapoints.reserveSocObjectId",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "placeholder": "Objekt auswählen …",
          "style": {
            "minWidth": "320px",
            "fontFamily": "monospace"
          },
          "multiline": true,
          "rows": 2,
          "showName": true,
          "expert": true,
          "expertMode": true
        },
        "stCtrlHeader": {
          "type": "header",
          "text": "Regelung / Grenzen",
          "xs": 12,
          "sm": 12,
          "md": 12
        },
        "storage.maxChargeW": {
          "type": "number",
          "label": "Max Charge (W)",
          "attr": "storage.maxChargeW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 5000,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "expert": true,
          "expertMode": true
        },
        "storage.maxDischargeW": {
          "type": "number",
          "label": "Max Discharge (W)",
          "attr": "storage.maxDischargeW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 5000,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "expert": true,
          "expertMode": true
        },
        "storage.stepW": {
          "type": "number",
          "label": "Step (W)",
          "attr": "storage.stepW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 50,
          "min": 0,
          "max": 10000,
          "step": 1,
          "expert": true,
          "expertMode": true
        },
        "storage.maxDeltaWPerTick": {
          "type": "number",
          "label": "Max ΔW/Tick",
          "attr": "storage.maxDeltaWPerTick",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 500,
          "min": 0,
          "max": 100000,
          "step": 10,
          "expert": true,
          "expertMode": true
        },
        "storage.pvMaxDeltaWPerTick": {
          "type": "number",
          "label": "PV‑Rampe: Max ΔW/Tick (Laden)",
          "attr": "storage.pvMaxDeltaWPerTick",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 1500,
          "min": 0,
          "max": 100000,
          "step": 10,
          "help": "Zusätzliche Rampe nur fürs PV‑Überschuss‑Laden. 0 = globale Max ΔW/Tick.",
          "expert": true,
          "expertMode": true
        },
        "storage.reserveEnabled": {
          "type": "checkbox",
          "label": "Reserve aktiv (Notstrom)",
          "attr": "storage.reserveEnabled",
          "default": false,
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        },
        "storage.reserveMinSocPct": {
          "type": "number",
          "label": "Reserve Min SoC (%)",
          "attr": "storage.reserveMinSocPct",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 20,
          "min": 0,
          "max": 100,
          "step": 0.1,
          "expert": true,
          "expertMode": true
        },
        "storage.pvEnabled": {
          "type": "checkbox",
          "label": "PV‑Überschuss‑Laden aktiv",
          "attr": "storage.pvEnabled",
          "default": true,
          "xs": 12,
          "sm": 6,
          "md": 6,
          "expert": true,
          "expertMode": true
        },
        "storage.pvExportThresholdW": {
          "type": "number",
          "label": "PV‑Schwelle Export (W)",
          "attr": "storage.pvExportThresholdW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 200,
          "min": 0,
          "max": 100000,
          "step": 10,
          "expert": true,
          "expertMode": true
        },
        "stMultiuseHeader": {
          "type": "header",
          "text": "Gate E – Speicherstrategie (Multiuse / SoC‑Zonen)",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "expert": true,
          "expertMode": true
        },
        "stLskHeader": {
          "type": "header",
          "text": "LSK / Peak‑Shaving über Speicher",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "expert": true,
          "expertMode": true
        },
        "storage.lskEnabled": {
          "type": "checkbox",
          "label": "LSK via Speicher aktiv",
          "attr": "storage.lskEnabled",
          "default": true,
          "xs": 12,
          "sm": 6,
          "md": 6,
          "help": "Wenn aktiv, kann der Speicher die Lastspitzenkappung unterstützen (Entladen bei Grenzwert‑Überschreitung).",
          "expert": true,
          "expertMode": true
        },
        "storage.lskDischargeEnabled": {
          "type": "checkbox",
          "label": "LSK: Entladen erlauben",
          "attr": "storage.lskDischargeEnabled",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": true,
          "help": "Wenn aktiv, darf der Speicher im LSK‑Bereich entladen, um Lastspitzen (Import) zu kappen."
        },
        "storage.lskChargeEnabled": {
          "type": "checkbox",
          "label": "LSK: Laden erlauben",
          "attr": "storage.lskChargeEnabled",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": true,
          "help": "Wenn aktiv, darf der Speicher im LSK‑Bereich auch oberhalb des Eigenverbrauchs‑Ziels weiter laden (z. B. PV‑Überschuss)."
        },
        "storage.lskMinSocPct": {
          "type": "number",
          "label": "LSK Min SoC (%)",
          "attr": "storage.lskMinSocPct",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 25,
          "min": 0,
          "max": 100,
          "step": 0.1,
          "help": "Unterhalb dieses SoC wird für LSK nicht mehr entladen (Notstrom‑Reserve bleibt geschützt).",
          "expert": true,
          "expertMode": true
        },
        "storage.lskMaxSocPct": {
          "type": "number",
          "label": "LSK Max SoC (%)",
          "attr": "storage.lskMaxSocPct",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 100,
          "min": 0,
          "max": 100,
          "step": 0.1,
          "help": "Oberhalb dieses SoC wird nicht weiter geladen (gilt u. a. für PV‑Überschuss‑Laden im LSK‑Bereich).",
          "expert": true,
          "expertMode": true
        },
        "storage.lskMaxDischargeW": {
          "type": "number",
          "label": "LSK Max Entladen (W)",
          "attr": "storage.lskMaxDischargeW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "help": "0 = global „Max Discharge (W)“. Damit begrenzt du die Entladeleistung, die LSK nutzen darf.",
          "expert": true,
          "expertMode": true
        },
        "storage.lskMaxChargeW": {
          "type": "number",
          "label": "LSK Max Laden (W)",
          "attr": "storage.lskMaxChargeW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "help": "0 = global „Max Charge (W)“. Gilt für PV‑Überschuss‑Laden oberhalb des Eigenverbrauch‑Max‑SoC (bis LSK Max SoC).",
          "expert": true,
          "expertMode": true
        },
        "storage.lskRefillAvgSeconds": {
          "type": "number",
          "label": "LSK Mittelwert-Fenster (s)",
          "attr": "storage.lskRefillAvgSeconds",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 120,
          "min": 5,
          "max": 1800,
          "step": 1,
          "help": "Zeitfenster für den gleitenden Mittelwert der NVP-Importleistung zur stabilen LSK-Reserve-Nachladung. Größer = ruhiger, aber träger.",
          "expert": true,
          "expertMode": true
        },
        "storage.lskRefillDeadbandW": {
          "type": "number",
          "label": "LSK Update-Schwelle (W)",
          "attr": "storage.lskRefillDeadbandW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 500,
          "min": 0,
          "max": 100000,
          "step": 10,
          "help": "Änderungen kleiner als dieser Wert werden beim LSK-Reserve-Nachladen gehalten (Anti-Flattern).",
          "expert": true,
          "expertMode": true
        },
        "stTariffHeader": {
          "type": "header",
          "text": "Tarif‑Entladung (NVP‑Regelung)",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "expert": true,
          "expertMode": true
        },
        "storage.tariffTargetGridImportW": {
          "type": "number",
          "label": "Tarif: Ziel Netzbezug (W)",
          "attr": "storage.tariffTargetGridImportW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 100,
          "min": 0,
          "max": 1000000,
          "step": 10,
          "help": "Bei Tarif (neutral/teuer/unbekannt) entlädt der Speicher, um den Netzbezug auf diesen Zielwert zu regeln. Ein kleiner positiver Wert (z. B. 100 W) verhindert Export durch Messrauschen.",
          "expert": true,
          "expertMode": true
        },
        "storage.tariffImportThresholdW": {
          "type": "number",
          "label": "Tarif: Deadband (W)",
          "attr": "storage.tariffImportThresholdW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 100,
          "min": 0,
          "max": 1000000,
          "step": 10,
          "help": "Totband um den Zielwert. Innerhalb dieser Bandbreite bleibt der Sollwert stabil (Anti-Flattern).",
          "expert": true,
          "expertMode": true
        },
        "stSelfHeader": {
          "type": "header",
          "text": "Eigenverbrauchs‑Optimierung über Speicher",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "expert": true,
          "expertMode": true
        },
        "storage.selfDischargeEnabled": {
          "type": "checkbox",
          "label": "Eigenverbrauch: Entladen aktiv",
          "attr": "storage.selfDischargeEnabled",
          "default": false,
          "xs": 12,
          "sm": 6,
          "md": 6,
          "help": "Wenn aktiv, entlädt der Speicher, um den Netzbezug bis zum Zielwert zu reduzieren (innerhalb SoC‑Grenzen).",
          "expert": true,
          "expertMode": true
        },
        "storage.selfMinSocPct": {
          "type": "number",
          "label": "Eigenverbrauch Min SoC (%)",
          "attr": "storage.selfMinSocPct",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 20,
          "min": 0,
          "max": 100,
          "step": 0.1,
          "help": "Unterhalb dieses SoC wird für Eigenverbrauch nicht mehr entladen.",
          "expert": true,
          "expertMode": true
        },
        "storage.selfMaxSocPct": {
          "type": "number",
          "label": "Eigenverbrauch Max SoC (%)",
          "attr": "storage.selfMaxSocPct",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 90,
          "min": 0,
          "max": 100,
          "step": 0.1,
          "help": "Bis zu diesem SoC wird bei PV‑Überschuss geladen. Wenn LSK Max SoC höher ist, kann darüber hinaus im LSK‑Bereich weiter geladen werden.",
          "expert": true,
          "expertMode": true
        },
        "storage.selfMaxDischargeW": {
          "type": "number",
          "label": "Eigenverbrauch Max Entladen (W)",
          "attr": "storage.selfMaxDischargeW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "help": "0 = global „Max Discharge (W)“. Damit begrenzt du die Entladeleistung, die Eigenverbrauch nutzen darf.",
          "expert": true,
          "expertMode": true
        },
        "storage.selfMaxChargeW": {
          "type": "number",
          "label": "Eigenverbrauch Max Laden (W)",
          "attr": "storage.selfMaxChargeW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "help": "0 = global „Max Charge (W)“. Damit begrenzt du die Ladeleistung im Eigenverbrauchs‑Bereich.",
          "expert": true,
          "expertMode": true
        },
        "stBackupHeader": {
          "type": "header",
          "text": "Notstrom / Reserve",
          "xs": 12,
          "sm": 12,
          "md": 12,
          "expert": true,
          "expertMode": true
        },
        "storage.reserveTargetSocPct": {
          "type": "number",
          "label": "Reserve Ziel SoC (%)",
          "attr": "storage.reserveTargetSocPct",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 25,
          "min": 0,
          "max": 100,
          "step": 0.1,
          "help": "Unterhalb dieses SoC wird die Reserve als „auffüllen“ betrachtet. PV‑Überschuss wird bevorzugt zum Laden genutzt; Netzladen optional (siehe unten).",
          "expert": true,
          "expertMode": true
        },
        "storage.reserveGridChargeW": {
          "type": "number",
          "label": "Reserve Netzladen (W) (optional)",
          "attr": "storage.reserveGridChargeW",
          "xs": 12,
          "sm": 6,
          "md": 6,
          "default": 0,
          "min": 0,
          "max": 1000000,
          "step": 50,
          "help": "0 = AUS. Wenn >0 und „Netzladen erlaubt“, lädt der Speicher bis zum Reserve‑Ziel‑SoC mit dieser Leistung aus dem Netz.",
          "expert": true,
          "expertMode": true
        }
      },
      "hidden": "!data.enableStorageControl"
    },
    "ems_storagefarm": {
      "type": "panel",
      "label": "EMS – Speicherfarm",
      "title": "Speicherfarm",
      "hidden": "!data.enableStorageFarm",
      "items": {
        "sfInfo": {
          "type": "staticText",
          "text": "Speicherfarm: Mehrere Speichersysteme als Pool oder in Gruppen betreiben. Hier ordnest du pro Speicher die Datenpunkte zu (SoC, Lade-/Entladeleistung, Sollwerte).",
          "md": 12
        },
        "storageFarm.mode": {
          "type": "select",
          "label": "Modus",
          "attr": "storageFarm.mode",
          "default": "pool",
          "options": [
            {
              "label": "Pool (alle Speicher agieren als ein großer Speicher)",
              "value": "pool"
            },
            {
              "label": "Gruppen (Speicher nach Gruppen/SoC-Bereichen)",
              "value": "groups"
            }
          ],
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "storageFarm.schedulerIntervalMs": {
          "type": "number",
          "label": "Farm‑Update‑Intervall (ms)",
          "attr": "storageFarm.schedulerIntervalMs",
          "default": 2000,
          "min": 250,
          "max": 60000,
          "step": 250,
          "xs": 12,
          "sm": 12,
          "md": 6,
          "help": "Intervall für Summenbildung/Monitoring der Farm. Empfehlung: 1000–2000 ms."
        },
        "storageFarm.storages": {
          "type": "table",
          "label": "Speicher in der Farm – Datenpunkt‑Zuordnung",
          "attr": "storageFarm.storages",
          "help": "Je Zeile ein Speichersystem. Für \"Pool\" reichen SoC + Lade-/Entladeleistung. Sollwert‑DPs werden für die Pool-/Gruppen‑Verteilung genutzt. Je Speicher entweder getrennte Soll‑DPs (Laden/Entladen) oder ein einzelner Signed‑Sollwert‑DP.",
          "style": {
            "width": "100%"
          },
          "tableStyle": {
            "minWidth": "2300px"
          },
          "items": [
            {
              "type": "checkbox",
              "label": "Aktiv",
              "attr": "enabled",
              "default": true,
              "xs": 12,
              "sm": 6,
              "md": 1,
              "style": {
                "minWidth": "90px"
              }
            },
            {
              "type": "text",
              "label": "Name",
              "attr": "name",
              "xs": 6,
              "sm": 6,
              "md": 2,
              "title": "Name",
              "style": {
                "minWidth": "160px"
              }
            },
            {
              "type": "objectId",
              "label": "SoC‑DP (%)",
              "attr": "socId",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "style": {
                "minWidth": "260px"
              }
            },
            {
              "type": "objectId",
              "label": "Ladeleistung‑DP (W)",
              "attr": "chargePowerId",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "style": {
                "minWidth": "260px"
              }
            },
            {
              "type": "checkbox",
              "label": "Vorzeichen Laden invertieren",
              "attr": "invertChargeSign",
              "default": false,
              "xs": 12,
              "sm": 6,
              "md": 2,
              "style": {
                "minWidth": "200px"
              },
              "tooltip": "Aktivieren, wenn der Hersteller beim Laden ein negatives Vorzeichen liefert bzw. erwartet. Gilt für Ladeleistung und Soll-Laden."
            },
            {
              "type": "objectId",
              "label": "Entladeleistung‑DP (W)",
              "attr": "dischargePowerId",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "style": {
                "minWidth": "260px"
              }
            },
            {
              "type": "checkbox",
              "label": "Vorzeichen Entladen invertieren",
              "attr": "invertDischargeSign",
              "default": false,
              "xs": 12,
              "sm": 6,
              "md": 2,
              "style": {
                "minWidth": "220px"
              },
              "tooltip": "Aktivieren, wenn der Hersteller beim Entladen ein negatives Vorzeichen liefert bzw. erwartet. Gilt für Entladeleistung und Soll-Entladen."
            },
            {
              "type": "objectId",
              "label": "Soll Laden (W) – DP",
              "attr": "setChargePowerId",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "style": {
                "minWidth": "260px"
              },
              "expert": true,
              "expertMode": true
            },
            {
              "type": "objectId",
              "label": "Soll Entladen (W) – DP",
              "attr": "setDischargePowerId",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "style": {
                "minWidth": "260px"
              },
              "expert": true,
              "expertMode": true
            },
            {
              "type": "objectId",
              "label": "Soll Leistung (W) – Signed DP",
              "attr": "setSignedPowerId",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "style": {
                "minWidth": "260px"
              },
              "expert": true,
              "tooltip": "Optional: Ein einzelner Sollwert-DP steuert Laden/Entladen über das Vorzeichen. Default: Entladen positiv, Laden negativ. Vorzeichen pro Richtung per Checkbox invertierbar.",
              "expertMode": true
            },
            {
              "type": "number",
              "label": "Kapazität (kWh)",
              "attr": "capacityKWh",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "min": 0,
              "max": 1000000,
              "step": 0.1,
              "style": {
                "minWidth": "160px"
              },
              "tooltip": "Optional für gewichteten Gesamt‑SoC.",
              "expert": true,
              "expertMode": true
            },
            {
              "type": "text",
              "label": "Gruppe",
              "attr": "group",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "style": {
                "minWidth": "140px"
              },
              "tooltip": "Optional (nur Gruppenmodus): Name der Gruppe.",
              "expert": true,
              "expertMode": true
            }
          ]
        },
        "storageFarm.groups": {
          "type": "table",
          "label": "Gruppen (optional – nur Modus \"Gruppen\")",
          "attr": "storageFarm.groups",
          "hidden": "(!data.storageFarm || data.storageFarm.mode !== 'groups') || (!data.ui || !data.ui.expertView)",
          "help": "Definiere Gruppen/SoC‑Bereiche. Speicher können über die Spalte \"Gruppe\" einer Gruppe zugeordnet werden.",
          "style": {
            "width": "100%"
          },
          "tableStyle": {
            "minWidth": "900px"
          },
          "items": [
            {
              "type": "checkbox",
              "label": "Aktiv",
              "attr": "enabled",
              "default": true,
              "xs": 12,
              "sm": 6,
              "md": 1,
              "style": {
                "minWidth": "90px"
              }
            },
            {
              "type": "text",
              "label": "Name",
              "attr": "name",
              "xs": 6,
              "sm": 6,
              "md": 3,
              "style": {
                "minWidth": "180px"
              }
            },
            {
              "type": "number",
              "label": "SoC min (%)",
              "attr": "socMin",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "min": 0,
              "max": 100,
              "step": 1,
              "style": {
                "minWidth": "140px"
              }
            },
            {
              "type": "number",
              "label": "SoC max (%)",
              "attr": "socMax",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "min": 0,
              "max": 100,
              "step": 1,
              "style": {
                "minWidth": "140px"
              }
            },
            {
              "type": "number",
              "label": "Priorität",
              "attr": "priority",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "min": 0,
              "max": 1000,
              "step": 1,
              "style": {
                "minWidth": "140px"
              },
              "tooltip": "Optional: höhere Priorität wird bevorzugt.",
              "expert": true,
              "expertMode": true
            }
          ],
          "expert": true,
          "expertMode": true
        }
      }
    },
    "historie": {
      "type": "panel",
      "title": "Historie",
      "label": "Historie",
      "items": {
        "history.instance": {
          "type": "text",
          "label": "History-Instanz (InfluxDB)",
          "attr": "history.instance",
          "xs": 12,
          "sm": 12,
          "help": "z. B. influxdb.0",
          "md": 6
        },
        "history.dp.pvPower": {
          "type": "objectId",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "label": "PV / Produktion – Leistung (W)",
          "attr": "history.datapoints.pvPower",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "history.dp.consumptionTotal": {
          "type": "objectId",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "label": "Verbrauch / Gebäude – Leistung (W)",
          "attr": "history.datapoints.consumptionTotal",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "history.dp.evcsPower": {
          "type": "objectId",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "label": "E-Mobilität / EVCS – Gesamtleistung (W)",
          "attr": "history.datapoints.evcsPower",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "history.dp.gridBuyPower": {
          "type": "objectId",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "label": "Netz – Bezug (W)",
          "attr": "history.datapoints.gridBuyPower",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "history.dp.gridSellPower": {
          "type": "objectId",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "label": "Netz – Einspeisung (W)",
          "attr": "history.datapoints.gridSellPower",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "history.dp.storageChargePower": {
          "type": "objectId",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "label": "Batterie – Ladeleistung (W)",
          "attr": "history.datapoints.storageChargePower",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "history.dp.storageDischargePower": {
          "type": "objectId",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "label": "Batterie – Entladeleistung (W)",
          "attr": "history.datapoints.storageDischargePower",
          "xs": 12,
          "sm": 12,
          "md": 6
        },
        "history.dp.storageSoc": {
          "type": "objectId",
          "types": [
            "state"
          ],
          "button": true,
          "newLine": false,
          "label": "Batterie – SoC (%)",
          "attr": "history.datapoints.storageSoc",
          "xs": 12,
          "sm": 12,
          "md": 6
        }
      }
    },
    "evcs": {
      "type": "panel",
      "label": "Ladepunkte",
      "items": {
        "datapoints.consumptionEvcs": {
          "type": "objectId",
          "label": "Leistung (W) (Legacy/optional)",
          "tooltip": "Wert für aktuelle Ladeleistung der Ladestation",
          "newLine": false,
          "expert": true
        },
        "datapoints.evcsStatus": {
          "type": "objectId",
          "label": "Status (Legacy/optional)",
          "tooltip": "Status der Ladestation (Text/Enum)",
          "newLine": false,
          "expert": true
        },
        "settings.evcsActive": {
          "type": "objectId",
          "label": "Ladestation aktiv (bool) (Legacy/optional)",
          "tooltip": "Schalt-Objekt zum Aktivieren/Deaktivieren der Ladestation. Leer lassen, wenn Adapter-eigenen Datenpunkt verwenden soll.",
          "newLine": true,
          "expert": true
        },
        "settings.evcsMode": {
          "type": "objectId",
          "label": "Betriebsmodus (1-3) (Legacy/optional)",
          "tooltip": "Schieberegler 1…3 (z. B. 1=Netz-Min, 2=Min+PV, 3=PV). Leer lassen, wenn Adapter-eigenen Datenpunkt verwenden soll.",
          "newLine": false,
          "expert": true
        },
        "settingsConfig.evcsCount": {
          "type": "number",
          "label": "Anzahl Ladepunkte",
          "min": 1,
          "max": 50,
          "step": 1,
          "default": 1,
          "sm": 12,
          "md": 6
        },
        "settingsConfig.evcsMaxPowerKw": {
          "type": "number",
          "label": "Maximale Ladeleistung (kW)",
          "default": 11,
          "min": 1,
          "max": 350,
          "tooltip": "Wird für die Füllung des Kreises im EVCS‑Popup verwendet (100% = hier eingetragene kW).",
          "newLine": true
        },
        "settingsConfig.evcsList": {
          "type": "table",
          "label": "Ladepunkte (EVCS) – Zuordnung",
          "help": "Zentrale Ladepunkt‑Tabelle (herstellerunabhängig). Jeder Eintrag entspricht einem Ladepunkt/Connector. In der Standardansicht werden nur die wichtigsten EMS‑Datenpunkte gezeigt. Weitere Monitoring/RFID/Expert‑Felder erscheinen im Admin‑Expertenmodus.",
          "attr": "settingsConfig.evcsList",
          "items": [
            {
              "type": "text",
              "label": "Name",
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "name",
              "title": "Name",
              "style": {
                "minWidth": "160px"
              }
            },
            {
              "type": "objectId",
              "label": "Ist‑Leistung‑DP (W)",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "attr": "powerId",
              "title": "Ist‑Leistung‑DP (W)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "340px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "State-ID der aktuellen Ladeleistung dieses Ladepunkts (W)."
            },
            {
              "type": "objectId",
              "label": "Sollstrom‑DP (A)",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "attr": "setCurrentAId",
              "title": "Sollstrom‑DP (A)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "340px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "State-ID für den Sollstrom (Ampere). Falls vorhanden, nutzt die EMS‑Logik diesen bevorzugt bei AC‑Wallboxen."
            },
            {
              "type": "objectId",
              "label": "Sollleistung‑DP (W)",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "attr": "setPowerWId",
              "title": "Sollleistung‑DP (W)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "340px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "State-ID für die Sollleistung (Watt). Falls vorhanden, nutzt die EMS‑Logik diesen bevorzugt bei DC‑Ladern oder wenn A‑Setpoint fehlt."
            },
            {
              "type": "select",
              "label": "EMS‑Modus",
              "attr": "userMode",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "options": [
                {
                  "label": "Auto",
                  "value": "auto"
                },
                {
                  "label": "PV‑Überschuss",
                  "value": "pv"
                },
                {
                  "label": "Min+PV",
                  "value": "minpv"
                },
                {
                  "label": "Boost",
                  "value": "boost"
                }
              ],
              "style": {
                "minWidth": "170px"
              },
              "tooltip": "Pro Ladepunkt: Auto / PV‑Überschuss / Min+PV / Boost."
            },
            {
              "type": "text",
              "label": "Notiz (optional)",
              "xs": 6,
              "sm": 6,
              "md": 6,
              "attr": "note",
              "title": "Notiz (optional)",
              "style": {
                "minWidth": "180px"
              },
              "expert": true
            },
            {
              "type": "objectId",
              "label": "Energie‑Zähler‑DP (kWh)",
              "xs": 12,
              "sm": 6,
              "md": 4,
              "attr": "energyTotalId",
              "title": "Energie‑Zähler‑DP (kWh)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "320px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "State-ID des Energiezählers dieses Ladepunkts (kWh).",
              "expert": true
            },
            {
              "type": "objectId",
              "label": "Status‑DP (optional)",
              "xs": 12,
              "sm": 6,
              "md": 4,
              "attr": "statusId",
              "title": "Status‑DP (optional)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "260px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "Optional: Status-State (string/number) der Wallbox.",
              "expert": true
            },
            {
              "type": "objectId",
              "label": "Freigabe‑DP (optional)",
              "xs": 12,
              "sm": 6,
              "md": 4,
              "attr": "activeId",
              "title": "Freigabe‑DP (optional)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "260px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "Optional: Freigabe/Enable-State (bool).",
              "expert": true
            },
            {
              "type": "objectId",
              "label": "Modus‑DP (legacy)",
              "xs": 12,
              "sm": 6,
              "md": 4,
              "attr": "modeId",
              "title": "Modus‑DP (legacy)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "260px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "Legacy: Hersteller-Modus-State. Wird in der NexoWatt-Logik nicht benötigt.",
              "expert": true,
              "hidden": true
            },
            {
              "type": "objectId",
              "label": "RFID‑DP (optional)",
              "xs": 12,
              "sm": 6,
              "md": 4,
              "attr": "rfidReadId",
              "title": "RFID‑DP (optional)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "260px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "Optional: RFID Reader State-ID (für Whitelist/Lernen).",
              "expert": true
            },
            {
              "type": "objectId",
              "label": "Sperre‑DP (optional)",
              "xs": 12,
              "sm": 6,
              "md": 4,
              "attr": "lockWriteId",
              "title": "Sperre‑DP (optional)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "260px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "Optional: Lock/Sperre State-ID (write).",
              "expert": true
            },
            {
              "type": "objectId",
              "label": "Online‑DP (optional)",
              "xs": 12,
              "sm": 6,
              "md": 4,
              "attr": "onlineId",
              "title": "Online‑DP (optional)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "260px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "Optional: true/false ob Wallbox online/verbunden ist.",
              "expert": true
            },
            {
              "type": "objectId",
              "label": "Enable‑Write‑DP (optional)",
              "xs": 12,
              "sm": 6,
              "md": 4,
              "attr": "enableWriteId",
              "title": "Enable‑Write‑DP (optional)",
              "types": [
                "state"
              ],
              "placeholder": "Objekt auswählen …",
              "style": {
                "minWidth": "260px",
                "fontFamily": "monospace"
              },
              "multiline": true,
              "rows": 2,
              "showName": true,
              "tooltip": "Optional: State-ID um die Wallbox zu aktivieren/deaktivieren (write).",
              "expert": true
            },
            {
              "type": "select",
              "label": "Typ",
              "attr": "chargerType",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "options": [
                {
                  "label": "AC",
                  "value": "ac"
                },
                {
                  "label": "DC",
                  "value": "dc"
                }
              ],
              "style": {
                "minWidth": "120px"
              },
              "tooltip": "Für Umrechnung/Regelung: AC (Strom‑geführt) oder DC (Watt‑geführt).",
              "expert": true
            },
            {
              "type": "number",
              "label": "Phasen",
              "attr": "phases",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "style": {
                "minWidth": "110px"
              },
              "min": 1,
              "max": 3,
              "tooltip": "1..3 (AC). Standard: 3.",
              "expert": true
            },
            {
              "type": "number",
              "label": "Spannung (V)",
              "attr": "voltageV",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "style": {
                "minWidth": "140px"
              },
              "min": 0,
              "max": 1000,
              "tooltip": "Für A↔W Umrechnung (AC). Typisch 230 oder 400.",
              "expert": true
            },
            {
              "type": "select",
              "label": "Regelbasis",
              "attr": "controlPreference",
              "xs": 12,
              "sm": 6,
              "md": 3,
              "options": [
                {
                  "label": "Auto",
                  "value": "auto"
                },
                {
                  "label": "A bevorzugen",
                  "value": "currentA"
                },
                {
                  "label": "W bevorzugen",
                  "value": "powerW"
                }
              ],
              "style": {
                "minWidth": "160px"
              },
              "tooltip": "Optional: erzwingt ob in A oder W geschrieben wird, wenn beide Setpoints existieren.",
              "expert": true
            },
            {
              "type": "number",
              "label": "Min A",
              "attr": "minCurrentA",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "style": {
                "minWidth": "110px"
              },
              "min": 0,
              "max": 80,
              "tooltip": "Minimaler Strom pro Phase.",
              "expert": true
            },
            {
              "type": "number",
              "label": "Max A",
              "attr": "maxCurrentA",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "style": {
                "minWidth": "110px"
              },
              "min": 0,
              "max": 500,
              "tooltip": "Maximaler Strom pro Phase.",
              "expert": true
            },
            {
              "type": "number",
              "label": "Max W",
              "attr": "maxPowerW",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "style": {
                "minWidth": "130px"
              },
              "min": 0,
              "max": 1000000,
              "tooltip": "Maximale Ladeleistung (W).",
              "expert": true
            },
            {
              "type": "number",
              "label": "Step A",
              "attr": "stepA",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "style": {
                "minWidth": "110px"
              },
              "min": 0,
              "max": 10,
              "tooltip": "Strom‑Schrittweite für Sollwert (A).",
              "expert": true
            },
            {
              "type": "number",
              "label": "Step W",
              "attr": "stepW",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "style": {
                "minWidth": "110px"
              },
              "min": 0,
              "max": 10000,
              "tooltip": "Leistungs‑Schrittweite für Sollwert (W).",
              "expert": true
            },
            {
              "type": "text",
              "label": "Station‑Key (optional)",
              "attr": "stationKey",
              "xs": 6,
              "sm": 6,
              "md": 3,
              "title": "Station‑Key",
              "style": {
                "minWidth": "160px",
                "fontFamily": "monospace"
              },
              "tooltip": "Gleicher Station‑Key = Stationsgruppe (gemeinsame Leistungsgrenze).",
              "expert": true
            },
            {
              "type": "number",
              "label": "Connector‑Nr. (optional)",
              "attr": "connectorNo",
              "xs": 6,
              "sm": 6,
              "md": 2,
              "min": 0,
              "max": 64,
              "step": 1,
              "title": "Connector‑Nr.",
              "style": {
                "minWidth": "140px"
              },
              "tooltip": "Optional: Nummer des Ladepunkts/Connectors innerhalb der Station (nur Dokumentation).",
              "expert": true
            },
            {
              "type": "checkbox",
              "label": "Boost erlaubt",
              "attr": "allowBoost",
              "xs": 6,
              "sm": 6,
              "md": 2,
              "default": true,
              "style": {
                "minWidth": "140px"
              },
              "tooltip": "Wenn deaktiviert, wird der Runtime‑Modus „boost“ für diesen Ladepunkt ignoriert.",
              "expert": true
            },
            {
              "type": "number",
              "label": "Boost Timeout (min)",
              "attr": "boostTimeoutMin",
              "xs": 12,
              "sm": 6,
              "md": 2,
              "min": 0,
              "max": 1000000,
              "step": 1,
              "style": {
                "minWidth": "170px"
              },
              "tooltip": "Optional: überschreibt den AC/DC Default für die Boost‑Maxdauer. 0/leer = globaler Default.",
              "expert": true
            }
          ],
          "style": {
            "width": "100%"
          },
          "tableStyle": {
            "minWidth": "1880px"
          }
        },
        "settingsConfig.stationGroups": {
          "type": "table",
          "label": "Stationsgruppen (gemeinsame Leistung)",
          "help": "Optional für DC‑Ladestationen mit mehreren Ladepunkten/Connectors: Ladepunkte mit gleichem Station‑Key teilen sich eine gemeinsame Leistungsgrenze.",
          "attr": "settingsConfig.stationGroups",
          "newLine": true,
          "items": [
            {
              "type": "text",
              "label": "Station‑Key",
              "attr": "stationKey",
              "xs": 6,
              "sm": 6,
              "md": 3,
              "title": "Station‑Key",
              "style": {
                "minWidth": "180px",
                "fontFamily": "monospace"
              },
              "tooltip": "Eindeutiger Schlüssel der Station/Gruppe (muss mit Ladepunkte→Station‑Key übereinstimmen)."
            },
            {
              "type": "text",
              "label": "Name (optional)",
              "attr": "name",
              "xs": 6,
              "sm": 6,
              "md": 4,
              "title": "Name",
              "style": {
                "minWidth": "220px"
              },
              "tooltip": "Freier Anzeigename (nur Dokumentation).",
              "expert": true
            },
            {
              "type": "number",
              "label": "Max. Station‑Leistung (kW)",
              "attr": "maxPowerKw",
              "xs": 6,
              "sm": 6,
              "md": 3,
              "min": 0,
              "max": 10000,
              "step": 0.1,
              "title": "Max. Leistung (kW)",
              "style": {
                "minWidth": "210px"
              },
              "tooltip": "Gesamt‑Leistungsgrenze dieser Station (Summe aller zugeordneten Ladepunkte)."
            },
            {
              "type": "text",
              "label": "Notiz (optional)",
              "attr": "note",
              "xs": 6,
              "sm": 6,
              "md": 6,
              "title": "Notiz",
              "style": {
                "minWidth": "220px"
              },
              "expert": true
            }
          ],
          "expert": true
        }
      }
    },
    "smarthome_config": {
      "type": "panel",
      "label": "SmartHome – Räume & Geräte (BETA)",
      "title": "SmartHome-Konfiguration (Räume/Funktionen/Geräte)",
      "items": {
        "smartHomeConfig.rooms": {
          "type": "table",
          "label": "Räume",
          "help": "Hier kannst du deine Räume definieren (z.B. Wohnen, Küche, Schlafen). Geräte verknüpfen später via roomId.",
          "attr": "smartHomeConfig.rooms",
          "items": [
            {
              "type": "text",
              "label": "ID",
              "help": "Technische ID (z.B. living, kitchen). Wird von Geräten referenziert.",
              "xs": 3,
              "sm": 3,
              "md": 2,
              "attr": "id",
              "title": "ID"
            },
            {
              "type": "text",
              "label": "Name",
              "help": "Anzeigename des Raums (z.B. Wohnen).",
              "xs": 5,
              "sm": 5,
              "md": 3,
              "attr": "name",
              "title": "Name"
            },
            {
              "type": "text",
              "label": "Etage",
              "help": "Optional: EG, OG, DG usw.",
              "xs": 4,
              "sm": 4,
              "md": 2,
              "attr": "floor",
              "title": "Etage",
              "expert": true
            },
            {
              "type": "text",
              "label": "Icon-Key",
              "help": "Icon-Bezeichner (z.B. room-living).",
              "xs": 4,
              "sm": 4,
              "md": 3,
              "attr": "icon",
              "title": "Icon-Key"
            },
            {
              "type": "number",
              "label": "Sortierung",
              "help": "Sortierreihenfolge (kleiner = weiter oben).",
              "xs": 3,
              "sm": 3,
              "md": 1,
              "attr": "order",
              "title": "Sortierung"
            },
            {
              "type": "checkbox",
              "label": "Aktiv",
              "xs": 3,
              "sm": 3,
              "md": 1,
              "attr": "enabled",
              "title": "Aktiv"
            }
          ]
        },
        "smartHomeConfig.functions": {
          "type": "table",
          "label": "Funktionen",
          "help": "Globale Funktionsgruppen (z.B. Licht, Beschattung, Heizung). Geräte verknüpfen später via functionId.",
          "attr": "smartHomeConfig.functions",
          "items": [
            {
              "type": "text",
              "label": "ID",
              "help": "Technische ID (z.B. light, blind, heating).",
              "xs": 3,
              "sm": 3,
              "md": 2,
              "attr": "id",
              "title": "ID"
            },
            {
              "type": "text",
              "label": "Name",
              "help": "Anzeigename (z.B. Licht).",
              "xs": 5,
              "sm": 5,
              "md": 3,
              "attr": "name",
              "title": "Name"
            },
            {
              "type": "text",
              "label": "Icon-Key",
              "help": "Icon-Bezeichner (z.B. func-light).",
              "xs": 4,
              "sm": 4,
              "md": 3,
              "attr": "icon",
              "title": "Icon-Key"
            },
            {
              "type": "number",
              "label": "Sortierung",
              "help": "Sortierreihenfolge (kleiner = weiter oben).",
              "xs": 3,
              "sm": 3,
              "md": 2,
              "attr": "order",
              "title": "Sortierung"
            },
            {
              "type": "checkbox",
              "label": "Aktiv",
              "xs": 3,
              "sm": 3,
              "md": 2,
              "attr": "enabled",
              "title": "Aktiv"
            }
          ]
        },
        "smartHomeConfig.devices": {
          "type": "table",
          "label": "Geräte / Kacheln",
          "help": "Zuordnung von Geräten/Kacheln zu Raum + Funktion. IO-Datenpunkte werden je nach Typ befüllt.",
          "attr": "smartHomeConfig.devices",
          "items": [
            {
              "type": "text",
              "label": "ID",
              "help": "Eindeutige Geräte-ID (z.B. living_light_ceiling).",
              "xs": 3,
              "sm": 3,
              "md": 2,
              "attr": "id",
              "title": "ID"
            },
            {
              "type": "text",
              "label": "Alias",
              "help": "Anzeigename der Kachel (z.B. Deckenlicht).",
              "xs": 5,
              "sm": 5,
              "md": 3,
              "attr": "alias",
              "title": "Alias"
            },
            {
              "type": "select",
              "label": "Typ",
              "help": "Kacheltyp (switch/dimmer/blind/rtr/sensor/scene).",
              "options": [
                {
                  "label": "Schalter",
                  "value": "switch"
                },
                {
                  "label": "Dimmer",
                  "value": "dimmer"
                },
                {
                  "label": "Jalousie/Rollo",
                  "value": "blind"
                },
                {
                  "label": "RTR (Raumtemperatur)",
                  "value": "rtr"
                },
                {
                  "label": "Sensor/Info",
                  "value": "sensor"
                },
                {
                  "label": "Szene",
                  "value": "scene"
                }
              ],
              "xs": 4,
              "sm": 4,
              "md": 2,
              "attr": "type",
              "title": "Typ"
            },
            {
              "type": "text",
              "label": "Raum-ID",
              "help": "ID eines Raums aus der Tabelle „Räume“ (z.B. living).",
              "xs": 4,
              "sm": 4,
              "md": 2,
              "attr": "roomId",
              "title": "Raum-ID"
            },
            {
              "type": "text",
              "label": "Funktions-ID",
              "help": "ID aus „Funktionen“ (z.B. light, blind).",
              "xs": 4,
              "sm": 4,
              "md": 2,
              "attr": "functionId",
              "title": "Funktions-ID"
            },
            {
              "type": "text",
              "label": "Icon-Key",
              "help": "Icon-Bezeichner (z.B. light-ceiling).",
              "xs": 4,
              "sm": 4,
              "md": 2,
              "attr": "icon",
              "title": "Icon-Key"
            },
            {
              "type": "select",
              "label": "Größe",
              "options": [
                {
                  "label": "S",
                  "value": "s"
                },
                {
                  "label": "M",
                  "value": "m"
                },
                {
                  "label": "L",
                  "value": "l"
                }
              ],
              "xs": 3,
              "sm": 3,
              "md": 2,
              "attr": "size",
              "title": "Größe"
            },
            {
              "type": "checkbox",
              "label": "Nur Anzeige",
              "help": "Wenn aktiviert, ist die Kachel read-only.",
              "xs": 3,
              "sm": 3,
              "md": 2,
              "attr": "behavior.readOnly",
              "title": "Nur Anzeige"
            },
            {
              "type": "objectId",
              "label": "switch.readId",
              "help": "Lesen/Schreiben für Schalter/Szene (bool).",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.switch.readId",
              "title": "switch.readId"
            },
            {
              "type": "objectId",
              "label": "level.readId",
              "help": "Lesen für Dimmer/Blind-Level.",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.level.readId",
              "title": "level.readId"
            },
            {
              "type": "objectId",
              "label": "level.writeId",
              "help": "Schreiben für Dimmer/Blind-Level.",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.level.writeId",
              "title": "level.writeId"
            },
            {
              "type": "objectId",
              "label": "cover.upId",
              "help": "Auf-Befehl (bool/Taster) für Jalousie.",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.cover.upId",
              "title": "cover.upId"
            },
            {
              "type": "objectId",
              "label": "cover.downId",
              "help": "Ab-Befehl (bool/Taster) für Jalousie.",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.cover.downId",
              "title": "cover.downId"
            },
            {
              "type": "objectId",
              "label": "cover.stopId",
              "help": "Stopp-Befehl (bool/Taster) für Jalousie.",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.cover.stopId",
              "title": "cover.stopId"
            },
            {
              "type": "objectId",
              "label": "climate.currentTempId",
              "help": "Ist-Temperatur für RTR.",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.climate.currentTempId",
              "title": "climate.currentTempId"
            },
            {
              "type": "objectId",
              "label": "climate.setpointId",
              "help": "Soll-Temperatur für RTR.",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.climate.setpointId",
              "title": "climate.setpointId"
            },
            {
              "type": "objectId",
              "label": "climate.modeId",
              "help": "Modus (Auto/Komfort/Nacht).",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.climate.modeId",
              "title": "climate.modeId"
            },
            {
              "type": "objectId",
              "label": "climate.humidityId",
              "help": "Raumfeuchte für RTR/Sensor.",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.climate.humidityId",
              "title": "climate.humidityId"
            },
            {
              "type": "objectId",
              "label": "sensor.readId",
              "help": "Allgemeiner Sensorwert (z.B. Leistung, Temperatur).",
              "types": [
                "state"
              ],
              "button": true,
              "xs": 6,
              "sm": 6,
              "md": 3,
              "attr": "io.sensor.readId",
              "title": "sensor.readId"
            },
            {
              "type": "checkbox",
              "label": "Favorit",
              "help": "Wenn aktiv, erscheint dieses Gerät im Favoriten-Tab der SmartHome-Ansicht.",
              "xs": 3,
              "sm": 3,
              "md": 2,
              "attr": "behavior.favorite",
              "title": "Favorit"
            }
          ]
        }
      },
      "hidden": true
    }
  }
}
